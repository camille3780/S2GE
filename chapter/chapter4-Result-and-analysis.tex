\begin{ZhChapter}

    \chapter{Implementation}
    The experimental implementation of this study is conducted on the Windows 11 operating system. Visual Studio Code (VS Code) is utilized as the primary development environment, integrated with the Anaconda distribution for Python to manage package dependencies and virtual environments. A range of scientific computing and machine learning packages are installed to facilitate algorithm development, model training, and evaluation workflows. Detailed configuration steps and setup instructions are described in the following subsection.

    \section{Hardware  and Software Requirements}

    Table \ref{table:hardware} provides detailed specifications of each hardware component utilized in our experimental environment and Table~\ref{tab:software} lists the software used in our experimental, along with their purposes and license types.

    \begin{table*}[htbp]
        \centering
        \caption{Hardware Requirements} \label{table:hardware}
        \makebox[\linewidth][c]{
            \renewcommand\arraystretch{1.2}{
                \begin{tabular}{| l | l |}
                    \hline
                    Component & Specification                                              \\
                    \hline
                    CPU       & 12th Gen Intel(R) Core(TM) i5-12500H @ 2.50 GHz            \\
                    RAM       & 16.0 GB (15.6 GB usable)                                   \\
                    Storage   & Built-in SSD (used for operating system and model storage) \\
                    \hline
                \end{tabular}
            }
        }
    \end{table*}

    \begin{table*}[htbp]
        \centering
        \caption{Software and Libraries Used in the Experiment} \label{tab:software}
        \vspace{1em}
        \makebox[\linewidth][c]{
            \renewcommand\arraystretch{1.2}{
                \begin{tabular}{| l | c | p{8cm} | c |}
                    \hline
                    Software/Library                 & Version & Purpose                                                                                                                                                    & License        \\
                    \hline
                    Ubuntu~\cite{ubuntu}             & 24.04.2 & Operating system                                                                                                                                           & MIT            \\
                    \hline
                    Python~\cite{python}             & 3.9.18  & The main programming language used to implement the core modules of the proposed system, including preprocessing, model training, and evaluation routines. & Python License \\
                    \hline
                    NumPy~\cite{numpy}               & 1.26.4  & Provides high-performance array structures and functions for numerical computing, especially efficient vector and matrix operations.                       & BSD            \\
                    \hline
                    Pandas~\cite{pandas}             & 2.2.2   & Offers powerful data manipulation and analysis tools, including DataFrame structures used for preprocessing and filtering packet data.                     & BSD            \\
                    \hline
                    Scikit-learn~\cite{scikit-learn} & 1.4.2   & Provides a wide range of machine learning algorithms, particularly the Multi-Layer Perceptron (MLP) classifier used in this study.                         & BSD            \\
                    \hline
                    mmh3~\cite{mmh3}                 & 4.0.1   & Implements MurmurHash3, a fast non-cryptographic hashing function used to convert tokens into integer values for embedding.                                & MIT            \\
                    \hline
                    PyTorch~\cite{torch}             & 2.2.2   & A deep learning framework used to define and train neural networks, including custom embedding and classification models.                                  & BSD            \\
                    \hline
                \end{tabular}
            }
        }
    \end{table*}


    \newpage
    \section{Environment Setup}
    This section will mainly introduce the installation procedures and environment setup required for the S2GE system. To ensure dependency management and maintain an isolated environment, Python virtual environments must be set up first. The intallation steps are listed below:

    1. Install Ubuntu
    Before experiment,  it is necessary to install Ubuntu (as shown in Figure~\ref{fig:Ubuntu}) Download the Ubuntu of version 24.04 on the official website.

    After confirming the installation, you can confirm the current version by entering cat os.

    \begin{verbatim}
    python3 -m venv ~/nids_env
    source ~/nids_env/bin/activate
    \end{verbatim}
    \begin{figure*}[htbp]
        \centering
        \includegraphics[width = 0.8\textwidth]{image/Ubuntu.jpg}
        \caption{Install an Ubuntu environment }
        \label{fig:Ubuntu}
    \end{figure*}

    2. Install Python
    Download the Python package on the office website, (see Figure~\ref{fig:Python}) for this study.

    \begin{figure*}[htbp]
        \centering
        \includegraphics[width = 0.8\textwidth]{image/python.jpg}
        \caption{Installation the python package}
        \label{fig:Python}
    \end{figure*}

    \newpage
    3. Activate the pre-configured virtual environment
    To use the S2GE environment, this command will be used to enable it.
    \begin{verbatim}
    python3 -m venv ~/nids_env
    source ~/nids_env/bin/activate
    \end{verbatim}




    Upon successful activation, the shell will displayed with \texttt{nids-env}, indicating that the virtual environment is active



    Figure~\ref{fig:Nids}.

    \begin{figure*}[htbp]
        \centering
        \includegraphics[width = 1\textwidth]{image/Nids-env.jpg}
        \caption{Create an independent Python executionnids environment in the current folder.}
        \label{fig:Nids}
    \end{figure*}




    4. Installing required packages
    \begin{verbatim}
    sudo apt install -y python3 python3-pip python3-venv build-essential
    pip install \
    numpy==1.26.4 \
    pandas==2.2.2 \
    scikit-learn==1.4.2 \
    mmh3==4.0.1 \
    torch==2.2.2+cpu \
    matplotlib seaborn

    \end{verbatim}






    \subsection{Data Preparation}
    In this experiment utilizes the latest 2024Internet of Things (IoT) dataset~\cite{ciciot2024} as the source of experimental data. The dataset contains different network packet data collected from various smart devices operating in real-world environments, including both normal traffic and diverse abnormal behaviors, effectively reflecting the security threats and anomaly patterns faced by IoT systems. With a large volume of data and complete annotations, the dataset provides rich traffic features such as packet size, communication protocol types, source and destination IPs, making it suitable for training and testing anomaly detection models. By leveraging this dataset, this study aims to validate the applicability and effectiveness of the proposed method across diverse IoT device environments and enhance the model's capability to identify anomalies in real-world scenarios. The experimental results will be presented and analyzed in detail in the following chapter.



    In this study, we conducted anomaly detection on a dataset comprising 238,687 samples with 10 network traffic features. We employed a feature representation method based on self-double hashing combined with an MLP model, and utilized the Mahalanobis distance to calculate anomaly scores for detecting anomalies in the CICIoT2024~\cite{ciciot2024} dataset. The dataset contains a total of 238,687 samples, and the 99th percentile of the anomaly scores was used as the decision threshold.


    This experiment uses GPU (CUDA) acceleration for model training, and the training process executes 10 epochs in total.
\end{ZhChapter}